<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Micronutrient Dietary Reference Values</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto p-4 sm:p-6 md:p-8">
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900">Micronutrient Dietary Reference Values</h1>
            <p class="mt-2 text-md text-gray-600">Comparison of Food and Nutrition Board (FNB), European Food Safety Authority (EFSA), and Turkish Food Codex (TFC) data.</p>
        </header>

        <main>
            <div class="max-w-md mx-auto mb-8">
                <label for="nutrient-select" class="block text-sm font-medium text-gray-700 mb-2">Select Micronutrient to Analyze:</label>
                <select id="nutrient-select" class="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 shadow-sm">
                    <!-- Options will be populated by JavaScript -->
                </select>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div id="intake-chart-container" class="bg-white p-4 rounded-xl shadow-lg min-h-[500px]"></div>
                <div id="ul-chart-container" class="bg-white p-4 rounded-xl shadow-lg min-h-[500px]"></div>
            </div>
        </main>
    </div>

    <script>
        // --- DATA ---
        // Raw CSV data from uploaded files is embedded here.
        const efsaTgkDataCSV = `Category,Nutrient,units,AgePeriodStart,AgePeriodEnd,Period,AgeGroupText,Gender,AI,AR,PRI,RI,UL,Safe and adequate intake,DRV,DML
Fats,Alpha-linolenic acid (ALA),E%,4,17,years,4 - 17 years,Both,0.5,NA,NA,NA,ND,,,2
Vitamins,Biotin_B7,μg/day,4,6,years,4 - 6 years,Both,25,NA,NA,NA,ND,,50,1250
Vitamins,Biotin_B7,μg/day,7,10,years,7 - 10 years,Both,25,NA,NA,NA,ND,,50,1250
Vitamins,Biotin_B7,μg/day,11,17,years,11 - 17 years,Both,35,NA,NA,NA,ND,,50,5000
Minerals,Calcium,mg/day,4,10,years,4 - 10 years,Both,NA,680,800,NA,ND,,800,750
Minerals,Calcium,mg/day,11,17,years,11 - 17 years,Both,NA,960,1150,NA,ND,,800,1500
Minerals,Chloride,g/day,4,6,years,4 - 6 years,Both,NA,NA,NA,NA,ND,2,800,
Minerals,Chloride,g/day,7,10,years,7 - 10 years,Both,NA,NA,NA,NA,ND,2.5,800,
Minerals,Chloride,g/day,11,17,years,11 - 17 years,Both,NA,NA,NA,NA,ND,3.1,800,
Vitamins,Folate_B9,μg/day,4,6,years,4 - 6 years,Both,NA,120,150,NA,300,,200,450
Vitamins,Folate_B9,μg/day,7,10,years,7 - 10 years,Both,NA,170,230,NA,400,,200,600
Vitamins,Folate_B9,μg/day,11,14,years,11 - 14 years,Both,NA,250,330,NA,600,,200,900
Vitamins,Folate_B9,μg/day,15,17,years,15 - 17 years,Both,NA,250,330,NA,700,,200,1000
Minerals,Iodine,μg/day,4,6,years,4 - 6 years,Both,NA,65,90,NA,200,,150,225
Minerals,Iodine,μg/day,7,10,years,7 - 10 years,Both,NA,85,120,NA,250,,150,375
Minerals,Iodine,μg/day,11,14,years,11 - 14 years,Both,NA,100,130,NA,450,,150,675
Minerals,Iodine,μg/day,15,17,years,15 - 17 years,Both,NA,110,150,NA,500,,150,750
Minerals,Iron,mg/day,4,6,years,4 - 6 years,Both,NA,5,7,NA,25,,14,21
Minerals,Iron,mg/day,7,10,years,7 - 10 years,Both,NA,6,8,NA,30,,14,21
Minerals,Iron,mg/day,11,17,years,11 - 17 years,Female,NA,8,11,NA,40,,14,42
Minerals,Iron,mg/day,11,17,years,11 - 17 years,Male,NA,8,11,NA,40,,14,42
Minerals,Magnesium,mg/day,4,6,years,4 - 6 years,Both,170,NA,NA,NA,250,,375,187.5
Minerals,Magnesium,mg/day,7,10,years,7 - 10 years,Both,230,NA,NA,NA,250,,375,187.5
Minerals,Magnesium,mg/day,11,17,years,11 - 17 years,Male,390,NA,NA,NA,250,,375,187.5
Minerals,Magnesium,mg/day,11,17,years,11 - 17 years,Female,280,NA,NA,NA,250,,375,187.5
Minerals,Manganese,mg/day,4,17,years,4 - 17 years,Both,NA,NA,NA,NA,ND,2,2,
Minerals,Molybdenum,μg/day,4,6,years,4 - 6 years,Both,NA,NA,NA,NA,ND,30,50,
Minerals,Molybdenum,μg/day,7,10,years,7 - 10 years,Both,NA,NA,NA,NA,ND,45,50,
Minerals,Molybdenum,μg/day,11,14,years,11 - 14 years,Both,NA,NA,NA,NA,ND,65,50,
Minerals,Molybdenum,μg/day,15,17,years,15 - 17 years,Both,NA,NA,NA,NA,ND,65,50,
Vitamins,Niacin_B3,mg/day,4,6,years,4 - 6 years,Both,NA,6,8,NA,200,,16,400
Vitamins,Niacin_B3,mg/day,7,10,years,7 - 10 years,Both,NA,8,11,NA,300,,16,450
Vitamins,Niacin_B3,mg/day,11,14,years,11 - 14 years,Male,NA,11,15,NA,500,,16,750
Vitamins,Niacin_B3,mg/day,11,14,years,11 - 14 years,Female,NA,10,13,NA,500,,16,750
Vitamins,Niacin_B3,mg/day,15,17,years,15 - 17 years,Male,NA,12,16,NA,600,,16,900
Vitamins,Niacin_B3,mg/day,15,17,years,15 - 17 years,Female,NA,10,13,NA,600,,16,900
Vitamins,Pantothenic Acid_B5,mg/day,4,6,years,4 - 6 years,Both,4,NA,NA,NA,ND,,6,
Vitamins,Pantothenic Acid_B5,mg/day,7,10,years,7 - 10 years,Both,4,NA,NA,NA,ND,,6,
Vitamins,Pantothenic Acid_B5,mg/day,11,17,years,11 - 17 years,Both,5,NA,NA,NA,ND,,6,
Minerals,Phosphorus,mg/day,4,10,years,4 - 10 years,Both,NA,440,550,NA,ND,,700,
Minerals,Phosphorus,mg/day,11,17,years,11 - 17 years,Both,NA,560,700,NA,ND,,700,
Minerals,Potassium,g/day,4,6,years,4 - 6 years,Both,2,NA,NA,NA,ND,,2,
Minerals,Potassium,g/day,7,9,years,7 - 9 years,Both,2.9,NA,NA,NA,ND,,2,
Minerals,Potassium,g/day,10,14,years,10 - 14 years,Both,3.7,NA,NA,NA,ND,,2,
Minerals,Potassium,g/day,15,17,years,15 - 17 years,Both,4,NA,NA,NA,ND,,2,
Vitamins,Riboflavin_B2,mg/day,4,6,years,4 - 6 years,Both,NA,0.7,0.8,NA,ND,,1.4,
Vitamins,Riboflavin_B2,mg/day,7,10,years,7 - 10 years,Both,NA,0.9,1.1,NA,ND,,1.4,
Vitamins,Riboflavin_B2,mg/day,11,14,years,11 - 14 years,Both,NA,1.2,1.4,NA,ND,,1.4,
Vitamins,Riboflavin_B2,mg/day,15,17,years,15 - 17 years,Both,NA,1.3,1.6,NA,ND,,1.4,
Minerals,Selenium,μg/day,4,6,years,4 - 6 years,Both,30,NA,NA,NA,85,,55,
Minerals,Selenium,μg/day,7,10,years,7 - 10 years,Both,45,NA,NA,NA,130,,55,
Minerals,Selenium,μg/day,11,14,years,11 - 14 years,Both,55,NA,NA,NA,200,,55,
Minerals,Selenium,μg/day,15,17,years,15 - 17 years,Both,70,NA,NA,NA,250,,55,
Minerals,Sodium,g/day,4,6,years,4 - 6 years,Both,NA,NA,NA,NA,ND,1.2,6,
Minerals,Sodium,g/day,7,10,years,7 - 10 years,Both,NA,NA,NA,NA,ND,1.3,6,
Minerals,Sodium,g/day,11,17,years,11 - 17 years,Both,NA,NA,NA,NA,ND,1.5,6,
Vitamins,Thiamin_B1,mg/day,4,6,years,4 - 6 years,Both,NA,0.5,0.6,NA,ND,,1.1,
Vitamins,Thiamin_B1,mg/day,7,9,years,7 - 9 years,Both,NA,0.7,0.8,NA,ND,,1.1,
Vitamins,Thiamin_B1,mg/day,10,14,years,10 - 14 years,Male,NA,0.9,1,NA,ND,,1.1,
Vitamins,Thiamin_B1,mg/day,10,14,years,10 - 14 years,Female,NA,0.8,0.9,NA,ND,,1.1,
Vitamins,Thiamin_B1,mg/day,15,17,years,15 - 17 years,Male,NA,1,1.2,NA,ND,,1.1,
Vitamins,Thiamin_B1,mg/day,15,17,years,15 - 17 years,Female,NA,0.9,1.1,NA,ND,,1.1,
Vitamins,Vitamin A,μg/day,4,6,years,4 - 6 years,Both,NA,200,250,NA,800,,800,1200
Vitamins,Vitamin A,μg/day,7,10,years,7 - 10 years,Both,NA,300,400,NA,1100,,800,1650
Vitamins,Vitamin A,μg/day,11,14,years,11 - 14 years,Male,NA,450,600,NA,1700,,800,2550
Vitamins,Vitamin A,μg/day,11,14,years,11 - 14 years,Female,NA,450,600,NA,1700,,800,2550
Vitamins,Vitamin A,μg/day,15,17,years,15 - 17 years,Male,NA,550,750,NA,2300,,800,3000
Vitamins,Vitamin A,μg/day,15,17,years,15 - 17 years,Female,NA,500,650,NA,2300,,800,3000
Vitamins,Vitamin B12,μg/day,4,6,years,4 - 6 years,Both,2.5,NA,NA,NA,ND,,2.5,
Vitamins,Vitamin B12,μg/day,7,10,years,7 - 10 years,Both,2.5,NA,NA,NA,ND,,2.5,
Vitamins,Vitamin B12,μg/day,11,14,years,11 - 14 years,Both,3.5,NA,NA,NA,ND,,2.5,
Vitamins,Vitamin B12,μg/day,15,17,years,15 - 17 years,Both,4,NA,NA,NA,ND,,2.5,
Vitamins,Vitamin B6,mg/day,4,6,years,4 - 6 years,Both,NA,0.7,0.9,NA,10,,1.4,
Vitamins,Vitamin B6,mg/day,7,10,years,7 - 10 years,Both,NA,0.9,1.1,NA,15,,1.4,
Vitamins,Vitamin B6,mg/day,11,14,years,11 - 14 years,Male,NA,1.2,1.4,NA,20,,1.4,
Vitamins,Vitamin B6,mg/day,11,14,years,11 - 14 years,Female,NA,1.1,1.3,NA,20,,1.4,
Vitamins,Vitamin B6,mg/day,15,17,years,15 - 17 years,Male,NA,1.4,1.7,NA,25,,1.4,
Vitamins,Vitamin B6,mg/day,15,17,years,15 - 17 years,Female,NA,1.2,1.4,NA,25,,1.4,
Vitamins,Vitamin C,mg/day,4,6,years,4 - 6 years,Both,NA,25,30,NA,ND,,80,
Vitamins,Vitamin C,mg/day,7,10,years,7 - 10 years,Both,NA,40,50,NA,ND,,80,
Vitamins,Vitamin C,mg/day,11,14,years,11 - 14 years,Both,NA,65,80,NA,ND,,80,
Vitamins,Vitamin C,mg/day,15,17,years,15 - 17 years,Male,NA,90,110,NA,ND,,80,
Vitamins,Vitamin C,mg/day,15,17,years,15 - 17 years,Female,NA,80,95,NA,ND,,80,
Vitamins,Vitamin D,μg/day,4,10,years,4 - 10 years,Both,15,NA,NA,NA,100,,5,25
Vitamins,Vitamin D,μg/day,11,14,years,11 - 14 years,Both,15,NA,NA,NA,100,,5,25
Vitamins,Vitamin D,μg/day,15,17,years,15 - 17 years,Both,15,NA,NA,NA,100,,5,25
Vitamins,Vitamin E,mg/day,4,6,years,4 - 6 years,Both,9,NA,NA,NA,120,,12,135
Vitamins,Vitamin E,mg/day,7,9,years,7 - 9 years,Both,9,NA,NA,NA,160,,12,135
Vitamins,Vitamin E,mg/day,10,10,years,10 years,Male,13,NA,NA,NA,160,,12,135
Vitamins,Vitamin E,mg/day,10,10,years,10 years,Female,11,NA,NA,NA,160,,12,135
Vitamins,Vitamin E,mg/day,11,14,years,11 - 14 years,Male,13,NA,NA,NA,220,,12,270
Vitamins,Vitamin E,mg/day,11,14,years,11 - 14 years,Female,11,NA,NA,NA,220,,12,270
Vitamins,Vitamin E,mg/day,15,17,years,15 - 17 years,Male,13,NA,NA,NA,260,,12,270
Vitamins,Vitamin E,mg/day,15,17,years,15 - 17 years,Female,12,NA,NA,NA,260,,12,270
Minerals,Zinc,mg/day,4,6,years,4 - 6 years,Both,NA,5.7,6.9,NA,12,,10,15
Minerals,Zinc,mg/day,7,10,years,7 - 10 years,Both,NA,7.5,9.4,NA,16,,10,15
Minerals,Zinc,mg/day,11,14,years,11 - 14 years,Male,NA,10.4,12.7,NA,22,,10,15
Minerals,Zinc,mg/day,11,14,years,11 - 14 years,Female,NA,8,10.2,NA,22,,10,15
Minerals,Zinc,mg/day,15,17,years,15 - 17 years,Male,NA,10.6,12.9,NA,26,,10,15
Minerals,Zinc,mg/day,15,17,years,15 - 17 years,Female,NA,7.5,9.3,NA,26,,10,15`;

        const fnbTgkDataCSV = `SOURCE=,,FNB,FNB,FNB,FNB,FNB,TFC
Category=,,DRI,DRI,DRI,DRI,DRI,DRI
Gender=,,Both,Male,Male,Female,Female,Both
Micronutrients,units,4–8 y,9–13 y,14–18 y,9–13 y2,14–18 y2,4-18 y
Biotin_B7,μg/d,12,20,25,20,25,50
Calcium,mg/d,1000,1300,1300,1300,1300,800
Chloride,g/d,1.9,2.3,2.3,2.3,2.3,0.8
Choline,mg/d,250,375,550,375,400,
Vitamin B12,μg/d,1.2,1.8,2.4,1.8,2.4,2.5
Copper,μg/d,440,700,890,700,890,1000
DHA,mg/d,,,,,,
Fluoride,mg/d,1,2,3,2,3,3.5
Folate_B9,μg/d,200,300,400,300,400,200
Iodine,μg/d,90,120,150,120,150,150
Iron,mg/d,10,8,11,8,15,14
Magnesium,mg/d,130,240,410,240,360,375
Manganese,mg/d,1.5,1.9,2.2,1.6,1.6,2
Molybdenum,μg/d,22,34,43,34,43,50
Niacin_B3,mg/d,8,12,16,12,14,16
Pantothenic Acid_B5,mg/d,3,4,5,4,5,6
Phosphorus,mg/d,500,1250,1250,1250,1250,700
Potassium,g/d,3.8,4.5,4.7,4.5,4.7,2
Riboflavin_B2,mg/d,0.6,0.9,1.3,0.9,1,1.4
Selenium,μg/d,30,40,55,40,55,55
Sodium,g/d,1.2,1.5,1.5,1.5,1.5,6
Thiamin_B1,mg/d,0.6,0.9,1.2,0.9,1,1.1
Vitamin A,μg/d,400,600,900,600,700,800
Vitamin B6,mg/d,0.6,1,1.3,1,1.2,1.4
Vitamin C,mg/d,25,45,75,45,65,80
Vitamin D,μg/d,15,15,15,15,15,5
Vitamin E,mg/d,7,11,15,11,15,12
Zinc,mg/d,5,8,11,8,9,10`;

        // --- UTILITY FUNCTIONS ---
        /**
         * A simple CSV to Array of Objects parser.
         * @param {string} csvText The CSV content.
         * @returns {Array<Object>}
         */
        function parseCSV(csvText) {
            const lines = csvText.split('\n');
            if (lines.length < 2) return [];
            const header = lines[0].split(',').map(h => h.trim());
            const data = [];
            for (let i = 1; i < lines.length; i++) {
                const values = lines[i].split(',');
                if (values.length === header.length) {
                    const entry = {};
                    for (let j = 0; j < header.length; j++) {
                        entry[header[j]] = values[j].trim();
                    }
                    data.push(entry);
                }
            }
            return data;
        }

        /**
         * Processes the raw data into a structured format for plotting.
         * @returns {Array<Object>} A tidy array of all data points.
         */
        function processData() {
            const allData = [];

            // 1. Process EFSA & TGK data
            const efsaRaw = parseCSV(efsaTgkDataCSV);
            const efsaValueTypes = ['AI', 'AR', 'PRI', 'UL', 'DRV', 'DML'];
            efsaRaw.forEach(row => {
                efsaValueTypes.forEach(type => {
                    const value = parseFloat(row[type]);
                    if (!isNaN(value) && row[type] !== 'NA' && row[type] !== 'ND') {
                        const source = (type === 'DRV' || type === 'DML') ? 'TFC' : 'EFSA';
                        allData.push({
                            Nutrient: row.Nutrient,
                            Unit: row.units,
                            AgeGroup: row['AgeGroupText'],
                            Gender: row.Gender,
                            ReferenceType: `${source}_${type}`,
                            Value: value,
                            Source: source
                        });
                    }
                });
            });

            // 2. Process FNB & TGK data (more complex parsing)
            const fnbLines = fnbTgkDataCSV.split('\n');
            const sourceLine = fnbLines[0].split(',');
            const categoryLine = fnbLines[1].split(',');
            const genderLine = fnbLines[2].split(',');
            const headerLine = fnbLines[3].split(',');

            const colInfo = [];
            for (let i = 2; i < headerLine.length; i++) {
                colInfo.push({
                    ageGroup: headerLine[i].trim(),
                    source: sourceLine[i].trim(),
                    category: categoryLine[i].trim(),
                    gender: genderLine[i].trim().replace('2', '')
                });
            }

            for (let i = 4; i < fnbLines.length; i++) {
                const dataLine = fnbLines[i].split(',');
                const nutrient = dataLine[0].trim();
                const unit = dataLine[1].trim();
                for (let j = 2; j < dataLine.length; j++) {
                    const value = parseFloat(dataLine[j]);
                    if (!isNaN(value)) {
                        const info = colInfo[j - 2];
                        const source = info.source === 'TFC' ? 'TFC' : 'FNB';
                        const refType = info.source === 'TFC' ? 'DRV' : info.category;
                        allData.push({
                            Nutrient: nutrient,
                            Unit: unit,
                            AgeGroup: info.ageGroup,
                            Gender: info.gender,
                            ReferenceType: `${source}_${refType}`,
                            Value: value,
                            Source: source
                        });
                    }
                }
            }
            return allData;
        }


        // --- PLOTTING FUNCTIONS ---
        const colorMap = {
            'EFSA_AI': '#1f77b4', 'EFSA_AR': '#ff7f0e', 'EFSA_PRI': '#2ca02c',
            'FNB_DRI': '#d62728', 'TFC_DRV': '#9467bd',
            'EFSA_UL': '#8c564b', 'TFC_DML': '#e377c2'
        };

        /**
         * Creates or updates the charts for a given nutrient.
         * @param {string} nutrientName The name of the nutrient to plot.
         * @param {Array<Object>} fullDataset The entire processed dataset.
         */
        function createCharts(nutrientName, fullDataset) {
            const nutrientData = fullDataset.filter(d => d.Nutrient === nutrientName);
            if (nutrientData.length === 0) {
                document.getElementById('intake-chart-container').innerHTML = `<p class='text-center text-gray-500'>No data found for '${nutrientName}'.</p>`;
                document.getElementById('ul-chart-container').innerHTML = '';
                return;
            }
            
            const unit = nutrientData[0].Unit;

            // Sort data by a rough age order for better visualization
            const ageOrder = (a, b) => {
                const startAgeA = parseInt(a.AgeGroup.split(' ')[0]);
                const startAgeB = parseInt(b.AgeGroup.split(' ')[0]);
                return startAgeA - startAgeB;
            };
            nutrientData.sort(ageOrder);

            // Data for Intake Chart
            const intakeTypes = ['EFSA_AI', 'EFSA_AR', 'EFSA_PRI', 'FNB_DRI', 'TFC_DRV'];
            const intakeData = nutrientData.filter(d => intakeTypes.includes(d.ReferenceType));

            // Data for Upper Limit Chart
            const ulTypes = ['EFSA_UL', 'TFC_DML'];
            const ulData = nutrientData.filter(d => ulTypes.includes(d.ReferenceType));

            const layoutTemplate = {
                barmode: 'group',
                xaxis: { 
                    title: 'Age and Gender Group', 
                    automargin: true,
                    tickangle: -45
                },
                yaxis: { title: `Value (${unit})`, automargin: true },
                margin: { l: 60, r: 20, t: 80, b: 150 },
                legend: { orientation: 'h', y: -0.4, x: 0.5, xanchor: 'center' },
                hovermode: 'x unified'
            };

            // Create Intake Chart
            const intakeTraces = [];
            const intakeGroups = [...new Set(intakeData.map(d => d.ReferenceType))];
            intakeGroups.forEach(type => {
                const typeData = intakeData.filter(d => d.ReferenceType === type);
                intakeTraces.push({
                    x: typeData.map(d => `${d.AgeGroup} (${d.Gender})`),
                    y: typeData.map(d => d.Value),
                    name: type,
                    type: 'bar',
                    marker: { color: colorMap[type] || '#cccccc' }
                });
            });

            const intakeLayout = { ...layoutTemplate, title: `<b>${nutrientName} - Dietary Reference Intake Values</b>` };
            Plotly.newPlot('intake-chart-container', intakeTraces, intakeLayout, {responsive: true});

            // Create Upper Limit Chart
            const ulTraces = [];
            const ulGroups = [...new Set(ulData.map(d => d.ReferenceType))];
             ulGroups.forEach(type => {
                const typeData = ulData.filter(d => d.ReferenceType === type);
                ulTraces.push({
                    x: typeData.map(d => `${d.AgeGroup} (${d.Gender})`),
                    y: typeData.map(d => d.Value),
                    name: type,
                    type: 'bar',
                    marker: { color: colorMap[type] || '#cccccc' }
                });
            });

            const ulLayout = { ...layoutTemplate, title: `<b>${nutrientName} - Upper Limits (UL & DML)</b>` };
            if (ulTraces.length > 0) {
                Plotly.newPlot('ul-chart-container', ulTraces, ulLayout, {responsive: true});
            } else {
                 document.getElementById('ul-chart-container').innerHTML = `<div class='flex items-center justify-center h-full'><p class='text-center text-gray-500'>No Upper Limit data found for '${nutrientName}'.</p></div>`;
            }
        }


        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            const allData = processData();
            const selectElement = document.getElementById('nutrient-select');
            
            // Get unique, sorted list of nutrients
            const nutrients = [...new Set(allData.map(d => d.Nutrient))].sort();

            // Populate dropdown
            nutrients.forEach(nutrient => {
                const option = document.createElement('option');
                option.value = nutrient;
                option.textContent = nutrient;
                selectElement.appendChild(option);
            });

            // Add event listener
            selectElement.addEventListener('change', (e) => {
                createCharts(e.target.value, allData);
            });

            // Initial chart generation
            if (nutrients.length > 0) {
                createCharts(nutrients[0], allData);
            }
        });
    </script>
</body>
</html>
